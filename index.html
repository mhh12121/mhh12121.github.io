<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>兜的破烂</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="兜的破烂">
<meta property="og:url" content="https://mhh12121.github.io/index.html">
<meta property="og:site_name" content="兜的破烂">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="兜的破烂">
  
    <link rel="alternate" href="/atom.xml" title="兜的破烂" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">兜的破烂</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">学习☆记录</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://mhh12121.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-java/Java-constantPool" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/05/java/Java-constantPool/" class="article-date">
  <time datetime="2019-06-05T15:48:00.000Z" itemprop="datePublished">2019-06-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/05/java/Java-constantPool/">Java String constatn pool</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>字符串常量池</p>
<p>//todo</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2019/06/05/java/Java-constantPool/" data-id="cjx415402000lv6ugx6prdq57" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Go/Concurrency" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/05/Go/Concurrency/" class="article-date">
  <time datetime="2019-06-05T15:48:00.000Z" itemprop="datePublished">2019-06-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/05/Go/Concurrency/">Concurrency Problem</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>Channel</li>
</ol>
<p>1.1 互斥</p>
<p>要先明白一句话</p>
<blockquote>
<blockquote>
<p>Share memory by communication, do not communicate by sharing memory<br>通过通信来分享内存，而不是靠分享内存来通信</p>
</blockquote>
</blockquote>
<p>这句话应该见过无数遍了，但这就是golang channel的核心思想</p>
<p>作为channel，顾名思义，就像一个管道一样，主要就是控制数据流向（DataFlow），从而可以控制多个协程间的协作，达到互斥，同步等目的</p>
<p>1.2 当把channel当作传入参数的时候要先确定一下箭头方向</p>
<p>chan&lt;-string：指的是可以入可以出的channel<br>&lt;-chan string：指的是receive-only channnel</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//gobyexample 例子</span></div><div class="line"><span class="comment">// This `ping` function only accepts a channel for sending</span></div><div class="line"><span class="comment">// values. It would be a compile-time error to try to</span></div><div class="line"><span class="comment">// receive on this channel.</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">ping</span><span class="params">(pings <span class="keyword">chan</span>&lt;- <span class="keyword">string</span>, msg <span class="keyword">string</span>)</span></span> &#123;</div><div class="line">    pings &lt;- msg</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// The `pong` function accepts one channel for receives</span></div><div class="line"><span class="comment">// (`pings`) and a second for sends (`pongs`).</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">pong</span><span class="params">(pings &lt;-<span class="keyword">chan</span> <span class="keyword">string</span>, pongs <span class="keyword">chan</span>&lt;- <span class="keyword">string</span>)</span></span> &#123;</div><div class="line">    msg := &lt;-pings</div><div class="line">    pongs &lt;- msg</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    pings := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">1</span>)</div><div class="line">    pongs := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">1</span>)</div><div class="line">    ping(pings, <span class="string">"passed message"</span>)</div><div class="line">    pong(pings, pongs)</div><div class="line">    fmt.Println(&lt;-pongs)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>Mutex互斥量</li>
</ol>
<p>2.1 01互斥量</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sema=<span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;,<span class="number">1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//每次使用前</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">Deposit</span><span class="params">(amount <span class="keyword">int</span>)</span></span>&#123;</div><div class="line">    sema&lt;-<span class="keyword">struct</span>&#123;&#125;&#123;&#125;<span class="comment">//锁住，往里面加一个</span></div><div class="line">    balance+=amount</div><div class="line">    &lt;-sema<span class="comment">//释放</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2.2 Sync.Mutex 互斥量</p>
<p>注意： golang的锁都不是可重入锁(ReentranLock),参考一下Java的 <img src="../Java-Concurrency.html" alt="可重入锁"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mu Sync.Mutex</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">Deposit</span><span class="params">(amount <span class="keyword">int</span>)</span></span> &#123;</div><div class="line">	mu.Lock()</div><div class="line">	balance = balance + amount</div><div class="line">	mu.Unlock()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// func Withdraw() int &#123;</span></div><div class="line"><span class="comment">// 	return &lt;-balances</span></div><div class="line"><span class="comment">// &#125;</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">Balance</span><span class="params">()</span> <span class="title">int</span></span> &#123;</div><div class="line"></div><div class="line">    mu.Lock()</div><div class="line">    <span class="keyword">defer</span> mu.Unlock</div><div class="line">	b := balance</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> b</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">Withdraw</span><span class="params">(amount <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</div><div class="line">    mu.Lock()</div><div class="line">    <span class="keyword">defer</span> mu.Unlock()</div><div class="line">	Deposit(-amount)<span class="comment">//这里，重用了mu的锁，但是，golang不支持重入锁，所以这里会进行阻塞</span></div><div class="line">	<span class="keyword">if</span> Balance() &lt; <span class="number">0</span> &#123;</div><div class="line">		Deposit(amount)</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span></div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2.2.* RWMutex 读写互斥量</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mu Sync.RWMutex</div></pre></td></tr></table></figure>
<p> <strong><em> 写操作 Lock(), UnLock() </em></strong><br> <strong><em> 读操作 RLock(), RUnlock() </em></strong></p>
<p>读锁即是 同一时间允许多个读的协程，但只允许一个写的协程</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">//重写Balance()</span></div><div class="line"><span class="keyword">var</span> mu Sync.RWMutex</div><div class="line"><span class="keyword">var</span> balance <span class="keyword">int</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">Balance</span><span class="params">()</span> <span class="title">int</span></span>&#123;</div><div class="line">    mu.RLock()</div><div class="line">    <span class="keyword">defer</span> mu.RUnlock()</div><div class="line">    b:=balance</div><div class="line">    <span class="keyword">return</span> b</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>Sync.WaitGroup 等待组 (Java CountDownLatch)</li>
</ol>
<p>Sync.WaitGroup<br>有三个methods:</p>
<ol>
<li>Add(delta int):将你要等待的协程加入，delta即加入的数量</li>
<li>Done() : 代表当前协程完成</li>
<li>Wait() : 等待所有协程完成(调用Done())，完成后即返回，否则一直阻塞</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//举个例子：</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">(number <span class="keyword">int</span>)</span></span>&#123;</div><div class="line">    <span class="keyword">var</span> wg Sync.WaitGroup</div><div class="line">    wg.Add(number)<span class="comment">//要同步的协程数</span></div><div class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;number;i++&#123;</div><div class="line">        <span class="keyword">go</span> doSth(&amp;wg,i)</div><div class="line">    &#125;</div><div class="line">    begin:=Time.Now()</div><div class="line">    wg.Wait()<span class="comment">//完成后继续往下跑</span></div><div class="line">    end:=Time.Now()<span class="comment">//这里还可以这样进行批量测试</span></div><div class="line">    dur:=Time.Duration(end-begin)</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">doSth</span><span class="params">(wg *Sync.WaitGroup,num <span class="keyword">int</span>)</span></span>&#123;</div><div class="line">    fmt.Println(num)</div><div class="line">    wg.Done()<span class="comment">//完成就Done</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>Sync.Once 单例（不知道怎么翻译。。。）</li>
</ol>
<p>顾名思义，就是只运行一次的意思，很显然适合单例模式<br>需要注意的是，Once只有一个Method<br>Do（func(){}）: Do方法只接受 <strong><em> 无参无返回值的函数 </em></strong><br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">var</span> once Sync.Once</div><div class="line">    doOnce:=<span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</div><div class="line">        fmt.Println(<span class="string">"do ONCE!"</span>)</div><div class="line">    &#125;</div><div class="line">    done:=<span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++&#123;</div><div class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</div><div class="line">            once.Do(doOnce)<span class="comment">//最终只输出一行 do ONCE！</span></div><div class="line">            done&lt;-<span class="literal">true</span></div><div class="line">        &#125;()</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++&#123;</div><div class="line">        &lt;-done</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2019/06/05/Go/Concurrency/" data-id="cjx4153zr000cv6ug60wg0zz1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Golang/">Golang</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Go/Slice" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/05/Go/Slice/" class="article-date">
  <time datetime="2019-06-05T15:48:00.000Z" itemprop="datePublished">2019-06-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/05/Go/Slice/">Something about Slice in Go</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Golang’s Slice is kinda diffrent===&gt;</p>
        
          <p class="article-more-link">
            <a href="/2019/06/05/Go/Slice/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2019/06/05/Go/Slice/" data-id="cjx4153zv000fv6ugvrsvcu6q" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java/Java-Class" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/05/java/Java-Class/" class="article-date">
  <time datetime="2019-06-05T15:48:00.000Z" itemprop="datePublished">2019-06-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/05/java/Java-Class/">class loading</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>类的加载</p>
<p>双亲委托模型</p>
<p>//todo</p>
<p>final，static 等在jvm 内存中的处理</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2019/06/05/java/Java-Class/" data-id="cjx4153zw000gv6ugnx8hbigz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LoginSecurity" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/05/LoginSecurity/" class="article-date">
  <time datetime="2019-06-05T15:48:00.000Z" itemprop="datePublished">2019-06-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/05/LoginSecurity/">Something about authentication and authorization</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Wat the hack is <a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="external">Oauth2</a>, <a href="https://tools.ietf.org/html/rfc7519" target="_blank" rel="external">JWT</a>, <a href="https://tools.ietf.org/html/rfc2818" target="_blank" rel="external">HTTPS</a>??? Followings are my notes:</p>
<h2 id="Oauth2"><a href="#Oauth2" class="headerlink" title="Oauth2"></a>Oauth2</h2><h2 id="TLS-HTTPS"><a href="#TLS-HTTPS" class="headerlink" title="TLS (HTTPS)"></a>TLS (HTTPS)</h2><p>TLS (Transport layer security) mainly works in Application Layer. TLS is the 3rd edition of SSL(Secure Socket Layer) so that it can work on any application over TCP.</p>
<p>It provides securty over serverl aspects:</p>
<ol>
<li>encryption(加密性)：指提交的数据不被获得</li>
<li>data Integerity(数据完整性)：指提交的的订单不被修改</li>
<li>Port Identification (端点鉴别，包括服务端和客户端)：指提交和接收的两边能互相确认身份</li>
</ol>
<p>至于流程验证，为了方便了解，我们先简化SSL：</p>
<p>举例用Bob和Alice</p>
<h4 id="第一步："><a href="#第一步：" class="headerlink" title="第一步："></a>第一步：</h4><h5 id="握手"><a href="#握手" class="headerlink" title="握手"></a>握手</h5><p>一、 因为这是在TCP之上，所以先进行TCP链接,Bob发起链接，Alice接收，这里略过</p>
<p>二、 要验证Alice是真正的Alice：</p>
<pre><code>1. Bob会发送一个 SSL 验证报文，,下图是 **SSL hello**报文
2. Alice 则用她的 **证书**进行回应，证书中包含了她的公钥
3. Bob收到证书，因为 证书被 **CA** 证实过了，所以Bob会知道Alice的真实性
4. 如果证书是真的，Bob会产生一个 **主密钥（MS）** 该密钥只用于这个SSL会话
</code></pre><p>三、 双方生成共同的密钥：</p>
<pre><code>1. Bob会用 Alice的公钥加密这个 **主密钥MS** 生成 **加密的主密钥(EMS)** 
2. Bob发送 **EMS** 给Alice
3. Alice收到 **EMS** 并用自己的 **私钥** 解开得到 **密钥（MS）**，这样双方都有一个共同的**密钥**
</code></pre><h4 id="第二步："><a href="#第二步：" class="headerlink" title="第二步："></a>第二步：</h4><h5 id="密钥导出"><a href="#密钥导出" class="headerlink" title="密钥导出"></a>密钥导出</h5><p>现在双方有一个共同的密钥，已经可以用作通信，但前面说到，要保证3点加密性，数据完整性，端点鉴别<br>而且对于Alice和Bob每个人来说，这些都用不同的密钥才会更安全</p>
<p>为此，可以让Alice和Bob各生成4个密钥</p>
<ol>
<li>E<sub>B</sub> 指Bob发送到Alice的数据的会话加密密钥</li>
<li>M<sub>B</sub> 指Bob发送到Alice的数据的会话MAC密钥</li>
<li>E<sub>A</sub> 指Alice发送到Bob的数据的会话加密密钥</li>
<li>M<sub>A</sub> 指Alice发送到Bob的数据的会话MAC密钥</li>
</ol>
<p>每人通过MS生成4个密钥，其中两个用于加密数据，另外两个用于验证数据完整性</p>
<h4 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h4><h5 id="数据传输"><a href="#数据传输" class="headerlink" title="数据传输"></a>数据传输</h5><p>但在数据传输中，经过TCP链接后，开始发送数据，一次发送了加密的数据，但另一个用于验证数据完整性的MAC去哪里了呢？<br>我们希望一次性就可以把加密数据和验证完整性的MAC都发送出去（即一次发送即可满足加密性和完整性）</p>
<p>为了解决这个问题，SSL将数据流分割成 <a href="#SSL-记录">记录</a> ，对每一个记录附加一个MAC用于完整性检查，然后加密 <strong>记录+MAC</strong> ：<br>比如，从Bob发送开始， 产生这个MAC， Bob将数据连同密钥M<sub>B</sub>放入一个hash函数，再用自己CA会话加密密钥 <strong>E<sub>B</sub></strong>,最后再传入TCP</p>
<p>然而，数据完整性仍然得不到保证，万一有中间人能抓取Bob发送的两个报文段，颠倒它们的顺序，调整TCP报文段的序号(seq)，将两个次序颠倒的报文段发送给Alice，<br>假设TCP报文段刚好封装一个记录（流式传输，所以不保证只含一个），Alice会这样做：</p>
<ol>
<li>Alice端运行的TCP认为一切正常，传递这两个记录给SSL子层</li>
<li>SSL解密这两个记录</li>
<li>SSL会用每个记录中的MAC来验证完整性</li>
<li>SSL将解密的两条记录的字节流传给应用层，但实际上因为颠倒了报文，次序不正确。</li>
</ol>
<p>解决如上问题，主要就要解决TCP的序号问题，所以就可以自己使用一个<strong>序号计数器</strong>：<br>Bob维护一个序号计数器，这个计数器不在记录中，而在MAC的计算中：即 </p>
<blockquote>
<blockquote>
<p>MAC=Hash(数据 + MAC密钥M<sub>B</sub> + 当前序号)</p>
</blockquote>
</blockquote>
<p>这样一来，以上颠倒了两个报文段的顺序，Alice解码发现顺序不对，就不会处理这两个报文</p>
<h3 id="SSL-记录"><a href="#SSL-记录" class="headerlink" title="SSL 记录"></a>SSL 记录</h3><p>该记录如下图所示：<br><img src="../SSL.png" alt="SSL记录格式"></p>
<p>主要由类型字段，版本字段，长度字段，数据字段和MAC构成，但其前三个字段是不加密的<br>类型字段：指出是握手报文还是有数据的报文，还被用于关闭SSL连接上（后面说到）</p>
<h3 id="连接关闭时注意的问题"><a href="#连接关闭时注意的问题" class="headerlink" title="连接关闭时注意的问题"></a>连接关闭时注意的问题</h3><p>一般来讲，关闭连接就会由Client端，即Bob发起TCP FIN报文请求断开，但这个易遭到截断攻击（truncation attack)：<br>如果中间人过早地发送TCP FIN报文，Server端（Alice）会认为已经收到所有Bob的数据。</p>
<p>解决方案：SSL记录中的<strong>类型字段</strong>指明这个记录是否用于关闭连接。这里还要注意，虽然这个字段是明文，但接收方仍然可以用记录的MAC对它进行鉴别</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2019/06/05/LoginSecurity/" data-id="cjx4153yj0001v6ugrwwf1fj8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/security/">security</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-js/gui_engine" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/04/js/gui_engine/" class="article-date">
  <time datetime="2019-06-04T15:29:00.159Z" itemprop="datePublished">2019-06-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/04/js/gui_engine/">从DocumentFragment看到GUI渲染</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这里主要说说<span style="color:#f92672">重绘(repaint)</span>和<span style="color:#f92672">回流(reflow)</span>的问题</p>
        
          <p class="article-more-link">
            <a href="/2019/06/04/js/gui_engine/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2019/06/04/js/gui_engine/" data-id="cjx415409000pv6ugvfcmi6a8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css/">css</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Go/GolangMux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/04/Go/GolangMux/" class="article-date">
  <time datetime="2019-06-04T15:28:21.951Z" itemprop="datePublished">2019-06-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/04/Go/GolangMux/">Golang Mux</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>开始做笔记…<br>(之前面试被怼了)</p>
        
          <p class="article-more-link">
            <a href="/2019/06/04/Go/GolangMux/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2019/06/04/Go/GolangMux/" data-id="cjx4153zt000dv6ugdhjil0gy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-DesignPattern" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/30/DesignPattern/" class="article-date">
  <time datetime="2018-04-30T15:48:00.000Z" itemprop="datePublished">2018-04-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/30/DesignPattern/">Notes about Design Pattern</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>For reviewing some most likely used design pattern:</p>
<h2 id="Singleton"><a href="#Singleton" class="headerlink" title="Singleton"></a><strong>Singleton</strong></h2><p>Most commonly<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton singleton = <span class="keyword">new</span> Singleton();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;<span class="comment">//in case of creating a new object</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getSingleton</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> singleton;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">other</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//other method</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Pros:</p>
<ol>
<li><p>Because only one instance exists in memory, it greatly decrease the usage of memory.Especially in the case that an object needs to be initialized and deleted frequently,while the instantiation and deletion can’t be optimized, Singleton pattern is the best choice.</p>
</li>
<li><p>Prevent multiple domination towards the same source.For example, an operation of writing in a file.</p>
</li>
<li></li>
</ol>
<p>Cons:</p>
<ol>
<li>Obviously, because singleton has instatiated itself, so it’s impossible to extend interface to it (abstract class,interface will not be instantiated )</li>
</ol>
<p>Scenes:</p>
<ol>
<li>generate unique key;</li>
<li>IO;</li>
<li>global stored in memory for calculating purpose.For exmaple, Spring Bean is set as a singleton by default so that spring can manage this bean life cycle(but if Bean use non-singleton like prototype pattern,after the initialization of Bean, it will be transfered to J2EE container,Spring no longer manages this Bean)</li>
</ol>
<h2 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a><strong>Proxy</strong></h2><h3 id="dynamic-proxy"><a href="#dynamic-proxy" class="headerlink" title="dynamic proxy"></a><strong>dynamic proxy</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayIH</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</div><div class="line">     <span class="comment">//被代理者</span></div><div class="line">     Class cls =<span class="keyword">null</span>;</div><div class="line">     <span class="comment">//被代理的实例</span></div><div class="line">     Object obj = <span class="keyword">null</span>;</div><div class="line">     <span class="comment">//我要代理谁</span></div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="title">GamePlayIH</span><span class="params">(Object _obj)</span></span>&#123;</div><div class="line">             <span class="keyword">this</span>.obj = _obj;</div><div class="line">     &#125;</div><div class="line">     <span class="comment">//调用被代理的方法</span></div><div class="line">     <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span></span></div><div class="line"><span class="function">                    <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">             Object result = method.invoke(<span class="keyword">this</span>.obj, args);</div><div class="line">             <span class="keyword">return</span> result;</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2018/04/30/DesignPattern/" data-id="cjx4153yb0000v6ug2z96zp46" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Design-Pattern/">Design Pattern</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java/Java-Concurrency" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/07/java/Java-Concurrency/" class="article-date">
  <time datetime="2018-03-07T03:00:00.000Z" itemprop="datePublished">2018-03-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/07/java/Java-Concurrency/">Java-Concurrency</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Actually we’ve learned the concept about multithread and the problem may cause.For instance, deadlock.</p>
        
          <p class="article-more-link">
            <a href="/2018/03/07/java/Java-Concurrency/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2018/03/07/java/Java-Concurrency/" data-id="cjx4153zz000kv6ugsvfy8v9h" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java/Java-Collection" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/07/java/Java-Collection/" class="article-date">
  <time datetime="2018-01-07T15:48:00.000Z" itemprop="datePublished">2018-01-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/07/java/Java-Collection/">Java-Collections</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Following is the summarize of the Java Collections:<br>
        
          <p class="article-more-link">
            <a href="/2018/01/07/java/Java-Collection/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mhh12121.github.io/2018/01/07/java/Java-Collection/" data-id="cjx4153zy000hv6ug1cxspkz8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Design-Pattern/">Design Pattern</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang/">Golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javascript/">Javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Regular-Expression/">Regular Expression</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/">golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/security/">security</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Design-Pattern/" style="font-size: 10px;">Design Pattern</a> <a href="/tags/Golang/" style="font-size: 10px;">Golang</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/Javascript/" style="font-size: 15px;">Javascript</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Regular-Expression/" style="font-size: 10px;">Regular Expression</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/golang/" style="font-size: 15px;">golang</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/security/" style="font-size: 10px;">security</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/06/05/java/Java-constantPool/">Java String constatn pool</a>
          </li>
        
          <li>
            <a href="/2019/06/05/Go/Concurrency/">Concurrency Problem</a>
          </li>
        
          <li>
            <a href="/2019/06/05/Go/Slice/">Something about Slice in Go</a>
          </li>
        
          <li>
            <a href="/2019/06/05/java/Java-Class/">class loading</a>
          </li>
        
          <li>
            <a href="/2019/06/05/LoginSecurity/">Something about authentication and authorization</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Doujohner<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>